---
title: "edld610_lab5"
author: "Cameron Kay and Ashley Miller"
date: "2/13/2019"
output: html_document
---

```{r setup, include=FALSE}
# load packages
library(tidyverse)
library(magrittr)
library(rio)
library(here)

# import and tidy column names
states_data <- import(here("data/states_all.csv"), setclass = "tibble") %>%
  janitor::clean_names()

```

```{r part1_ash}

```

```{r part2_cam}
# prepare data
cam_data <- states_data %>%
  mutate(rev_enr = total_revenue / enroll) %>%
  group_by(state) %>%
  summarize(avg_revenue = mean(rev_enr,             na.rm = TRUE),
            avg_math    = mean(avg_math_8_score,    na.rm = TRUE),
            avg_reading = mean(avg_reading_8_score, na.rm = TRUE)) %>%
  filter(!is.na(avg_revenue),
         !is.na(avg_math),
         !is.na(avg_reading)) %>%
  gather(key   = "content",
         value = "avg_score",
         avg_math:avg_reading) %>%
  mutate(content = gsub("avg_", "", content),
         content = stringr::str_to_title(content),
         state   = stringr::str_to_title(state)) %>%
  arrange(state)

# reproduce plot
ggplot(cam_data, aes(x = avg_revenue, y = avg_score)) +
  geom_point() +
  facet_wrap(~content) +
  theme_minimal()


```
